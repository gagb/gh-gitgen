#!/bin/bash
# Main entry point for the GitGen CLI extension

# Check if the correct syntax is provided
if [[ $# -ne 2 || ( "$1" != "issue" && "$1" != "pr" ) ]]; then
  echo "Usage: gh gitgen <issue|pr> <number>"
  exit 1
fi

# Extract the command and number
command="$1"
number="$2"

if [[ "$command" == "pr" ]]; then
  echo "PR functionality is not implemented yet."
  exit 1
fi

# Auto-detect the current GitHub repository owner and repo name
repo_info=$(gh repo view --json owner,name -q ".owner.login + \"/\" + .name")
if [[ -z "$repo_info" ]]; then
  echo "Failed to detect the current GitHub repository."
  exit 1
fi

# Run the Python script with the repo info, command, and number as input
python3 "$(dirname "$0")/gen.py" "$repo_info" "$command" "$number"
